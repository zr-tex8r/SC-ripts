<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>マウスカーソルを左右に動かすとくるくるしてくれる☃ちゃん</title>
    <style>
      #main {
        margin: 50pt;
      }
      #snowman {
        margin: 0 auto;
        width: 100pt; height: 100pt;
      }
      #svg-snowman {
        width: 100pt; height: 100pt;
      }
      #muffler {
        fill: #FF0000; stroke: #FF0000;
      }
    </style>
    <script>
      window.addEventListener("load", (event) => {
        const tick = 25;
        const sensitivity = 0.5;
        const maxspeed = 7;

        const snowman = document.getElementById("snowman");

        let turn = 0, tvel = 0;
        let prevX, currX;

        document.addEventListener("mousemove", (event) => {
          prevX = (prevX === undefined) ? event.clientX : currX;
          currX = event.clientX;
          let difX = currX - prevX;
          let [sign, d] = (difX < 0) ? [-1, -difX] : [1, difX];
          tvel += sign * sensitivity * Math.sqrt(d / 10) / 10;
          // console.log(tvel);
        });

        setInterval(() => {
          const v = (tvel < -maxspeed) ? -maxspeed :
                    (tvel > maxspeed) ? maxspeed : tvel;
          turn += v * (tick / 1000);
          const ang = Math.round((turn % 1) * 360000) / 1000;
          snowman.style.transform = `rotate(${ang}deg)`;
        }, tick);

      });
    </script>
  </head>
  <body>
    <h1>マウスカーソルを左右に動かすとくるくるしてくれる☃ちゃん</h1>
    <div id="main">
      <div id="snowman">
        <svg id="svg-snowman"
          xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100">
          <g transform="matrix(1,0,0,-1,0,100)"
            stroke-width="1.389" stroke-linecap="round">
            <path stroke="black" fill="white"
              d="M 50 72 C 64 72 76 65 76 55
                76 51 72 47 67 44 79 41 84 32 84 25
                84 13 75 8 68 8 L 32 8
                C 25 8 16 13 16 25 16 32 21 41 33 44
                28 47 24 51 24 55 24 65 36 72 50 72 Z"/>
            <g fill="black">
              <ellipse cx="40" cy="56" rx="2" ry="3"/>
              <ellipse cx="60" cy="56" rx="2" ry="3"/>
            </g>
            <path stroke="black" fill="none"
              d="M 40 48 C 45 45 55 45 60 48"/>
            <g stroke="black" fill="black">
              <path d="M 58 90 L 77 81 74 61 C 66 60 50 66 46 72
                L 58 90 Z"/>
              <path d="M 20 31 C 19 33 14 41 13 42
                12 43 10 43 7 44 4 46 6 46 8 46
                9 46 11 44 12 44 14 46 14 47 15 49
                16 51 16 49 16 48 16 46 14 44 15 43
                16 42 21 35 22 33 23 31 21 30 20 31 Z"/>
              <path d="M 80 31 C 81 33 86 41 87 42
                88 43 90 43 93 44 96 46 94 46 92 46
                91 46 89 44 88 44 86 46 86 47 85 49
                84 51 84 49 84 48 84 46 86 44 85 43
                84 42 79 35 78 33 77 31 79 30 80 31 Z"/>
            </g>
            <g stroke="black" fill="black">
              <ellipse cx="50" cy="16" rx="3" ry="3"/>
              <ellipse cx="50" cy="26" rx="3" ry="3"/>
            </g>
            <g stroke="black" fill="white">
              <circle cx="7" cy="28" r="4"/>
              <circle cx="8" cy="68" r="4"/>
              <circle cx="13" cy="55" r="4"/>
              <circle cx="23" cy="76" r="4"/>
              <circle cx="42" cy="89" r="4"/>
              <circle cx="74" cy="89" r="4"/>
              <circle cx="88" cy="73" r="4"/>
              <circle cx="92" cy="53" r="4"/>
              <circle cx="94" cy="23" r="4"/>
            </g>
            <g id="muffler">
              <path d="M 27 48 C 42 38 58 38 73 48
                75 46 76 44 77 41 77 39 75 37 73 36
                74 33 74 31 76 26 75 25 72 24 66 23
                66 27 65 30 63 34 42 30 32 35 24 41
                25 45 26 47 27 48 Z"/>
            </g>
          </g>
        </svg>
      </div>
    </div>
  </body>
</html>
